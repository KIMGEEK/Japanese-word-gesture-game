<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Motion Backend Test</title>
    <style>
        body { font-family: sans-serif; text-align: center; }
        #container {
            width: 640px;
            height: 480px;
            border: 2px solid #333;
            margin: 0 auto;
            position: relative;
            background-color: #f0f0f0;
        }
        /* ì›€ì§ì¼ ë¹¨ê°„ ì  (ì†ê°€ë½) */
        #cursor {
            width: 20px;
            height: 20px;
            background-color: red;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
            transform: translate(-50%, -50%); /* ì¤‘ì‹¬ ê¸°ì¤€ ë°°ì¹˜ */
            transition: all 0.05s linear; /* ë¶€ë“œëŸ¬ìš´ ì›€ì§ì„ */
        }
        #log {
            margin-top: 20px;
            font-family: monospace;
            color: #555;
        }
    </style>
</head>
<body>
    <h2>ğŸ–ï¸ ëª¨ì…˜ ì¸ì‹ ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸</h2>
    <p>ì¹´ë©”ë¼ ì•ì—ì„œ ê²€ì§€ ì†ê°€ë½ì„ ì›€ì§ì—¬ë³´ì„¸ìš”.</p>
    
    <div id="container">
        <div id="cursor"></div>
    </div>

    <div id="log">ë°ì´í„° ëŒ€ê¸° ì¤‘...</div>

    <script>
        // 1. ì›¹ì†Œì¼“ ì—°ê²° (ë°±ì—”ë“œ ì£¼ì†Œì™€ ì¼ì¹˜í•´ì•¼ í•¨)
        const ws = new WebSocket("ws://localhost:8000/ws");
        
        const cursor = document.getElementById('cursor');
        const log = document.getElementById('log');
        const container = document.getElementById('container');

        // ì—°ê²° ì„±ê³µ ì‹œ
        ws.onopen = () => {
            console.log("ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.");
            log.innerText = "ì„œë²„ ì—°ê²° ì„±ê³µ! ë°ì´í„° ìˆ˜ì‹  ëŒ€ê¸° ì¤‘...";
        };

        // ë©”ì‹œì§€ ìˆ˜ì‹  ì‹œ (ì—¬ê¸°ê°€ í•µì‹¬)
        ws.onmessage = (event) => {
            // 2. ë°ì´í„° íŒŒì‹±
            const data = JSON.parse(event.data);
            
            // 3. ë¡œê·¸ ì¶œë ¥
            log.innerText = `ìˆ˜ì‹ ëœ ì¢Œí‘œ: X=${data.x.toFixed(4)}, Y=${data.y.toFixed(4)}`;

            // 4. ë¹¨ê°„ ì  ì´ë™ (Unityì²˜ëŸ¼ ì¢Œí‘œ ë³€í™˜)
            // x, yëŠ” 0.0 ~ 1.0 ë¹„ìœ¨ì´ë¯€ë¡œ ì»¨í…Œì´ë„ˆ í¬ê¸°ë¥¼ ê³±í•´ì¤Œ
            const x = data.x * container.clientWidth;
            const y = data.y * container.clientHeight;

            cursor.style.left = `${x}px`;
            cursor.style.top = `${y}px`;
        };

        ws.onclose = () => {
            log.innerText = "ì„œë²„ ì—°ê²°ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
            console.log("ì—°ê²° ì¢…ë£Œ");
        };

        ws.onerror = (error) => {
            console.error("ì—ëŸ¬ ë°œìƒ:", error);
        };
    </script>
</body>
</html>